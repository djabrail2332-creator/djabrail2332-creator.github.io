<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Админка</title>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:#0f172a;
  color:#fff;
}
.login, .panel{max-width:420px;margin:40px auto;padding:20px}
input,select,button{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:none;
  margin-bottom:10px;
  font-size:16px;
}
button{background:#2563eb;color:#fff;font-weight:600}
.card{
  background:#020617;
  border-radius:14px;
  padding:12px;
  margin-bottom:10px;
}
.number{font-size:18px;font-weight:700}
.small{font-size:13px;opacity:.7}
.actions button{
  margin-top:6px;
  background:#334155;
}
.hidden{display:none}
</style>
</head>

<body>

<div class="login" id="login">
  <h2>Вход в админку</h2>
  <input id="loginUser" placeholder="Логин">
  <input id="loginPass" type="password" placeholder="Пароль">
  <button onclick="auth()">Войти</button>
</div>

<div class="panel hidden" id="panel">
  <h2>Добавить номер</h2>
  <input id="newNumber" placeholder="Номер (например 8925-161-66-28)">
  <select id="newStatus">
    <option value="в наличии">В наличии</option>
    <option value="продано">Продано</option>
  </select>
  <button onclick="addNumber()">Добавить</button>

  <h2 style="margin-top:20px">Список</h2>
  <input id="search" placeholder="Поиск">
  <div id="list"></div>
</div>

<script>
const API = "https://api.nomersh95.ru/numbers";
const USER = "Daudov";
const PASS = "Daudov959";

function auth(){
  if(
    document.getElementById("loginUser").value === USER &&
    document.getElementById("loginPass").value === PASS
  ){
    document.getElementById("login").classList.add("hidden");
    document.getElementById("panel").classList.remove("hidden");
    load();
  } else {
    alert("Неверные данные");
  }
}

function load(){
  fetch(API).then(r=>r.json()).then(d=>render(d));
}

function render(data){
  const q=document.getElementById("search").value;
  const box=document.getElementById("list");
  box.innerHTML="";
  data.forEach(n=>{
    if(q && !n.number.includes(q)) return;
    box.innerHTML+=`
      <div class="card">
        <div class="number">${n.number}</div>
        <div class="small">Статус: ${n.status}</div>
        <div class="actions">
          <button onclick="setStatus(${n.id},'в наличии')">В наличии</button>
          <button onclick="setStatus(${n.id},'продано')">Продано</button>
          <button onclick="del(${n.id})">Удалить</button>
        </div>
      </div>
    `;
  });
}

function addNumber(){
  fetch(API,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      number:document.getElementById("newNumber").value,
      status:document.getElementById("newStatus").value
    })
  }).then(()=>{document.getElementById("newNumber").value="";load();});
}

function setStatus(id,status){
  fetch(API+"/"+id,{
    method:"PUT",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({status})
  }).then(load);
}

function del(id){
  fetch(API+"/"+id,{method:"DELETE"}).then(load);
}

document.getElementById("search").oninput=load;
</script>

</body>
</html>
