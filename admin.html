<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Админка</title>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:#0f172a;
  color:#fff;
}
.wrap{
  max-width:420px;
  margin:30px auto;
  padding:15px;
}
h2{
  text-align:center;
}
input,button{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:none;
  font-size:16px;
  margin-bottom:10px;
}
button{
  background:#2563eb;
  color:#fff;
  font-weight:600;
}
.card{
  background:#020617;
  border-radius:14px;
  padding:12px;
  margin-bottom:10px;
}
.num{
  font-size:18px;
  font-weight:700;
}
.row{
  display:flex;
  gap:6px;
  margin-top:8px;
}
.row button{
  flex:1;
  background:#334155;
}
.hidden{display:none}
.small{opacity:.7;font-size:13px}
</style>
</head>

<body>

<div class="wrap" id="login">
  <h2>Вход</h2>
  <input id="u" placeholder="Логин">
  <input id="p" type="password" placeholder="Пароль">
  <button onclick="login()">Войти</button>
</div>

<div class="wrap hidden" id="panel">
  <h2>Добавить номер</h2>
  <input id="num" placeholder="8925-161-66-28">
  <button onclick="add()">Добавить</button>

  <input id="search" placeholder="Поиск">

  <div id="list"></div>
</div>

<script>
const API = "https://api.nomersh95.ru/numbers";
const USER = "Daudov";
const PASS = "Daudov959";

function login(){
  if(u.value===USER && p.value===PASS){
    loginBox.style.display="none";
    panel.classList.remove("hidden");
    load();
  } else alert("Неверные данные");
}

const loginBox=document.getElementById("login");
const panel=document.getElementById("panel");

function load(){
  fetch(API)
    .then(r=>r.json())
    .then(show);
}

function show(data){
  const q=search.value;
  list.innerHTML="";
  data.forEach(n=>{
    if(q && !n.number.includes(q)) return;
    list.innerHTML+=`
      <div class="card">
        <div class="num">${n.number}</div>
        <div class="small">Статус: ${n.status}</div>
        <div class="row">
          <button onclick="status(${n.id},'в наличии')">В наличии</button>
          <button onclick="status(${n.id},'продано')">Продано</button>
          <button onclick="del(${n.id})">Удалить</button>
        </div>
      </div>
    `;
  });
}

function add(){
  if(!num.value) return;
  fetch(API,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      number:num.value,
      status:"в наличии",
      category:"обычный"
    })
  }).then(()=>{
    num.value="";
    load();
  });
}

function status(id,s){
  fetch(API+"/"+id,{
    method:"PUT",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({status:s})
  }).then(load);
}

function del(id){
  fetch(API+"/"+id,{method:"DELETE"}).then(load);
}

search.oninput=load;
</script>

</body>
</html>
