<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ö—Ä–∞—Å–∏–≤—ã–µ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã–µ –Ω–æ–º–µ—Ä–∞</title>

<style>
body {
    margin: 0;
    font-family: system-ui, Arial, sans-serif;
    background: #0f172a;
    color: #e5e7eb;
    padding: 16px;
}
.container { max-width: 900px; margin: auto; }
h1 { text-align: center; color: #38bdf8; }

.card {
    background: #020617;
    border-radius: 14px;
    padding: 16px;
    margin-top: 16px;
}

textarea {
    width: 100%;
    height: 140px;
    background: #020617;
    color: #e5e7eb;
    border: 1px solid #334155;
    border-radius: 10px;
    padding: 12px;
    font-size: 16px;
}

button {
    width: 100%;
    padding: 14px;
    margin-top: 12px;
    border: none;
    border-radius: 10px;
    background: #38bdf8;
    color: #020617;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
}

.number {
    background: #020617;
    padding: 12px;
    border-radius: 10px;
    margin-top: 8px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
}

.top10 { border: 2px solid #facc15; background: #1e293b; }
.top30 { border: 1px solid #38bdf8; }

.price { color: #4ade80; font-weight: bold; }
.score { color: #facc15; font-size: 14px; }

.highlight span {
    color: #facc15;
    font-weight: bold;
}

.pair {
    font-size: 12px;
    color: #38bdf8;
}
</style>
</head>

<body>
<div class="container">
<h1>–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∫—Ä–∞—Å–∏–≤—ã—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤</h1>

<div class="card">
<textarea id="input" placeholder="
+7 (999) 000-00-00
8-999-888-77-66
79991222112
79994567890
"></textarea>
<button onclick="analyze()">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å (–¥–æ 100 –Ω–æ–º–µ—Ä–æ–≤)</button>
</div>

<div class="card" id="output"></div>
</div>

<script>
function analyze() {
    const text = document.getElementById("input").value;
    const cleaned = text.replace(/[^\d+]/g, " ");
    let matches = cleaned.match(/(\+7|7|8)?\d{10}/g);

    if (!matches) {
        document.getElementById("output").innerHTML = "<p>–ù–æ–º–µ—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>";
        return;
    }

    matches = matches.slice(0, 100);
    const phones = matches.map(normalize);

    const countMap = {};
    phones.forEach(p => countMap[p] = (countMap[p] || 0) + 1);

    const list = phones.map(num => {
        const score = calcScore(num);
        return {
            num,
            score,
            price: estimatePrice(score),
            pair: countMap[num] > 1
        };
    });

    list.sort((a, b) => b.score - a.score);

    let html = "<h2>–†–µ–∑—É–ª—å—Ç–∞—Ç (–æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ)</h2>";

    list.forEach((item, i) => {
        let cls = "";
        if (i < 10) cls = "top10";
        else if (i < 30) cls = "top30";

        html += `
        <div class="number ${cls}">
            <div class="highlight">${highlight(item.num)}</div>
            <div class="score">‚≠ê ${item.score}</div>
            <div class="price">${item.price.toLocaleString()} ‚ÇΩ</div>
            ${item.pair ? "<div class='pair'>üîÅ –ø–∞—Ä–Ω—ã–π</div>" : ""}
        </div>`;
    });

    document.getElementById("output").innerHTML = html;
}

function normalize(n) {
    n = n.replace(/\D/g, "");
    if (n.length === 10) n = "7" + n;
    if (n.startsWith("8")) n = "7" + n.slice(1);
    return "+" + n;
}

function calcScore(num) {
    const n = num.slice(2);
    let score = 0;

    if (/^(\d)\1+$/.test(n)) score += 100;
    if (/(\d)\1{3}$/.test(n)) score += 80;
    if (n === n.split("").reverse().join("")) score += 60;
    if (/(\d)\1(\d)\2/.test(n)) score += 40;
    if ("0123456789".includes(n.slice(-4))) score += 30;

    const freq = {};
    n.split("").forEach(d => freq[d] = (freq[d] || 0) + 1);
    Object.values(freq).forEach(v => {
        if (v > 2) score += 10;
    });

    return score;
}

function estimatePrice(score) {
    return 1000 + score * 300;
}

function highlight(num) {
    const n = num.slice(2);
    const freq = {};
    n.split("").forEach(d => freq[d] = (freq[d] || 0) + 1);

    return "+7" + n.split("").map(d =>
        freq[d] > 1 ? `<span>${d}</span>` : d
    ).join("");
}
</script>

</body>
</html>
