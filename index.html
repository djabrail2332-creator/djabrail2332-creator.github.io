<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–§–∏–ª—å—Ç—Ä –∫—Ä–∞—Å–∏–≤—ã—Ö –Ω–æ–º–µ—Ä–æ–≤</title>

<style>
body {
    background:#0f172a;
    color:#e5e7eb;
    font-family:Arial,sans-serif;
    padding:20px;
}
.container { max-width:1100px; margin:auto; }

textarea, input {
    width:100%;
    padding:12px;
    font-size:16px;
    border-radius:10px;
    margin-top:10px;
}

button {
    padding:12px;
    margin-top:10px;
    border-radius:10px;
    border:none;
    background:#38bdf8;
    font-weight:bold;
    cursor:pointer;
    width:100%;
}

.filters {
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:10px;
    margin-top:10px;
}

.group {
    background:#020617;
    border-radius:12px;
    padding:12px;
    margin-top:12px;
}
.group.pair { border:2px solid #38bdf8; }
.group.gold { border-color:#facc15; }

.number { padding:6px 0; }
.highlight span { color:#facc15; font-weight:bold; }
.badge { font-size:12px; margin-bottom:6px; color:#38bdf8; }
</style>
</head>

<body>
<div class="container">
<h1>–ö—Ä–∞—Å–∏–≤—ã–µ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã–µ –Ω–æ–º–µ—Ä–∞</h1>

<textarea id="input" placeholder="
8928-735-05-75
8928-735-05-25
8928-735-79-89
8928-735-79-88
"></textarea>

<button onclick="analyze()">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button>

<div class="filters">
    <label><input type="checkbox" id="fPairs" checked> –ü–∞—Ä–Ω—ã–µ –Ω–æ–º–µ—Ä–∞</label>
    <label><input type="checkbox" id="fSingle" checked> –û–±—ã—á–Ω—ã–µ –Ω–æ–º–µ—Ä–∞</label>
    <label><input type="checkbox" id="fGold"> –¢–æ–ª—å–∫–æ –∑–æ–ª–æ—Ç–æ</label>
</div>

<input id="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Ü–∏—Ñ—Ä–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä 89 –∏–ª–∏ 735)" oninput="render()">

<button onclick="copyText()">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç</button>

<div id="output"></div>
</div>

<script>
let groups = [];

function analyze() {
    const text = document.getElementById("input").value;
    const digits = text.replace(/\D/g,"");

    let raw=[];
    for(let i=0;i+10<digits.length;i+=11){
        raw.push(digits.substr(i,11));
    }
    if(!raw.length){
        document.getElementById("output").innerHTML="–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ";
        return;
    }

    const phones = raw.map(p=>{
        if(p.startsWith("8")) p="7"+p.slice(1);
        if(p.length===10) p="7"+p;
        return "+7"+p.slice(1);
    });

    const used=new Set();
    groups=[];

    for(let i=0;i<phones.length;i++){
        if(used.has(i)) continue;
        let g=[phones[i]];
        used.add(i);

        for(let j=i+1;j<phones.length;j++){
            if(used.has(j)) continue;
            if(hamming(phones[i],phones[j])===1){
                g.push(phones[j]);
                used.add(j);
            }
        }

        groups.push({
            nums:g,
            pair:g.length>1,
            gold:isGold(g)
        });
    }

    render();
}

function render(){
    const showPairs=document.getElementById("fPairs").checked;
    const showSingle=document.getElementById("fSingle").checked;
    const onlyGold=document.getElementById("fGold").checked;
    const search=document.getElementById("search").value;

    let html="";

    groups.forEach(g=>{
        if(g.pair && !showPairs) return;
        if(!g.pair && !showSingle) return;
        if(onlyGold && !g.gold) return;

        const joined=g.nums.join("");
        if(search && !joined.includes(search)) return;

        html+=`<div class="group ${g.pair?"pair":""} ${g.gold?"gold":""}">
            ${g.pair?'<div class="badge">üîÅ –ü–∞—Ä–Ω—ã–µ</div>':""}
            ${g.gold?'<div class="badge">ü•á –ó–æ–ª–æ—Ç–æ</div>':""}`;

        g.nums.forEach(n=>{
            html+=`<div class="number highlight">${highlight(n)}</div>`;
        });

        html+="</div>";
    });

    document.getElementById("output").innerHTML=html || "–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤";
}

function hamming(a,b){
    let d=0;
    for(let i=0;i<a.length;i++) if(a[i]!==b[i]) d++;
    return d;
}

function isGold(g){
    if(g.length>1) return true;
    const n=g[0].slice(-4);
    if(n[0]===n[1] || n[2]===n[3]) return true;
    if(n===n.split("").reverse().join("")) return true;
    return false;
}

function highlight(num){
    const n=num.slice(2);
    const f={};
    n.split("").forEach(d=>f[d]=(f[d]||0)+1);
    return "+7"+n.split("").map(d=>f[d]>1?`<span>${d}</span>`:d).join("");
}

function copyText(){
    let text="";
    groups.forEach(g=>{
        g.nums.forEach(n=>text+=n+"\n");
        text+="\n";
    });
    navigator.clipboard.writeText(text);
    alert("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ");
}
</script>

</body>
</html>
